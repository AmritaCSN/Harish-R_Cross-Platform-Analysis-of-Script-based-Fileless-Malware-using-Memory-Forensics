# Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics


## Overview

* Fileless malware can use either system binaries or scripting languages to execute the malicious code. 

* The fileless script-based malware is designed to take advantage of the specific features and vulnerabilities in the operating systems.

* Some fileless script-based malware can attack multiple operating systems.

* This research work specifically focuses on script-based fileless malware, understanding its behavior in Windows and Linux helps us to evaluate the potential impact of the threat.

## Tool Used

Not every script can act as fileless malware. It requires a combination of specific characteristics, the script must be able to use legitimate software or process to execute, and mustnâ€™t leave any file on the disk for persistence. So to analyze them **cuckoo sandbox** has been set in the virtual environment for Windows malware and Online Sandbox has been used for Linux malware, for the memory forensic **volatility** tool is used. 

## Cuckoo Sandbox
<p style="text-align: justify;">
  The Cuckoo sandbox automates the analysis of suspicious files by monitoring their behavior in an isolated environment, and assessing whether they engage in malicious activities. Cuckoo can effectively analyze a wide range of file types, including executables, PDFs, documents, and script-based files like JavaScript, Python, Bash, and VBS scripts. Its architecture comprises two main components: the Host and Guest machines. In the context of this experiment, the host machine is responsible for overseeing the guest machine and managing the analysis process. Ubuntu 16 is utilized for the host, while the guest machine, where submitted samples run in a clean environment, is configured with Windows 7 in a VMware Workstation. The sandbox provides detailed insights into the analyzed files, including tracing all calls and processes executed by the submitted sample, creating a memory dump of the virtual machine, capturing network traffic in a PCAP file, and generating screenshots for comprehensive analysis.

  <p align="center">
  <img src="https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/edbd43f7-d4a3-4cbd-9695-8ae5218a9517" alt="Image">
</p>


<h4 align="center">
  Fig 1: Cuckoo Sandbox Architecture  
</h4>

  
## Volatility Tool

Volatility, an open-source memory forensics framework, empowers investigators to extract data from the temporary memory used by a computer during its operation. This tool proves invaluable for investigating various incidents, including malware infections, data breaches, and user activities. Its capabilities encompass extracting process information and providing a comprehensive list of running processes and their associated memory regions for the identification of potentially malicious processes. Additionally, Volatility can reveal network information, detailing all system network connections, IP addresses, and ports involved, aiding in the detection of suspicious network activities. Extracting registry hives from volatile memory is another function, enabling the identification of malicious registry entries created by malware. Moreover, Volatility allows the extraction of file system information from volatile memory, aiding in the identification of files manipulated by malware. Lastly, it provides insights into user activity, allowing investigators to discern the actions undertaken by users on the system.

## Block Diagram

The methodology employed in this project is elucidated in the flowchart depicted in Figure 2. According to the diagram, the fileless script malware undergoes examination in a sandbox to determine its nature. If the script utilizes legitimate software or deposits malicious files in the process memory, Following the aforementioned steps, a snapshot of the virtual machine (VM) is captured for further analysis. This snapshot encompasses the memory dump of the machine, which is then subjected to analysis using the Volatility tool.

<p align="center">
  <img src="https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/cb0f9e69-57f8-497f-acd9-8868a0faa508" alt="Image">
</p>


<h4 align="center">
  Fig 2: flowchart of the methodology	
</h4>


## output

Figure 3 illustrates the utilization of the volatility tool for examining a memory dump. As depicted, the **psxview plugin** reveals hidden processes, exposing two instances of iexplore.exe with distinct PIDs, namely 3820 and 4012. Figure 4 Leveraging the **cmdline plugin** allows us to discern the most recent command executed by the program. Notably, the process with PID 4012 initiates iexplore.exe without user knowledge in the PID 3820, figure 5 is a confirmation supported by the **malfind plugin**. The malfind plugin plays a crucial role in identifying instances of process injection within the system.   


![image](https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/d476e990-e30d-4a82-a1a8-bb3d7b8cd5ff)

<h4 align="center">
  Fig 3: psxview plugin	
</h4>



![image](https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/0e903698-20de-4d9d-9cc0-4e0580cd44aa)

<h4 align="center">
	Fig 4: cmdline plugin
</h4>


![image](https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/7b4f11e3-db10-4acb-98d9-b12c33df598c)

<h4 align="center">
	Fig 5: malfind plugin
</h4>



In Figure 6, the **console plugin** reveals the brief usage of PowerShell, leaving no trace in the dump file but documented in the cuckoo sandbox analyzer. PowerShell activity is recorded during memory dumping, accompanied by the creation of a new file in the app data folder, after which the process is terminated. 


![image](https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/167435f7-08be-40e9-b663-b926386b65d7)

<h4 align="center">
	Fig 6: console plugin
</h4>





















