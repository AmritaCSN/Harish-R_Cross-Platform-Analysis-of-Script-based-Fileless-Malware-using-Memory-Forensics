# Cross-Platform-Analysis of Script-based Fileless Malware using Memory Forensics


## Overview

* Fileless malware can use either system binaries or scripting languages to execute the malicious code. 

* The fileless script-based malware is designed to take advantage of the specific features and vulnerabilities in the operating systems.

* Some fileless script-based malware can attack multiple operating systems.

* This research work specifically focuses on script-based fileless malware, understanding its behavior in Windows and Linux helps us to evaluate the potential impact of the threat.

## Block Diagram

The methodology employed in this project is elucidated in the flowchart depicted in Figure 2. According to the diagram, the fileless script malware undergoes examination in a sandbox to determine its nature. If the script utilizes legitimate software or deposits malicious files in the process memory, Following the aforementioned steps, a snapshot of the virtual machine (VM) is captured for further analysis. This snapshot encompasses the memory dump of the machine, which is then subjected to analysis using the Volatility tool.

<p align="center">
  <img src="https://github.com/AmritaCSN/Harish-R_Cross-Platform-Analysis-of-Script-based-Fileless-Malware-using-Memory-Forensics/assets/120771272/cb0f9e69-57f8-497f-acd9-8868a0faa508" alt="Image">
</p>


<h4 align="center">
  Fig 1: flowchart of the methodology	
</h4>

## Requirements

### Malware Samples

* The Script-based fileless malware samples are downloaded from the malware bazaar
* The used malware samples are JavaScript, VBS, PHP, Rar, Python, HTML, and .sh 

```
https://bazaar.abuse.ch/browse/
```

### Cuckoo Sandbox

* To Install the Cuckoo sandbox in a virtual machine follow the steps in the below Link

```
https://cuckoo.readthedocs.io/en/latest/installation/host/installation/
```

### Volatility Tool
* To install the volatility tool in Linux
```
git clone https://github.com/volatilityfoundation/volatility.git && cd volatility && sudo python setup.py build && sudo python setup.py install
```

### Memory Extraction

* To obtain a memory dump of Windows malware, we can use the Cuckoo Sandbox, which provide the full memory dumb of the virtual machine. 
* For Linux we have to take a memory dump of the malware manually by the snapshot


## Flow

* Download malware samples from Malware Bazaar.
* Use the Tag command in the search box on Malware Bazaar to pinpoint specific types of malware.
* Download the chosen malware and extract the files from the downloaded archive.
* Utilize Cuckoo Sandbox to conduct a thorough analysis of the malware and utilize Hybrid analysis for the Linux malware samples
* If the malware is identified as fileless, proceed with the analysis.
* Use the Volatility tool to analyze the memory dump obtained during the analysis process.

### Commands

* The plugins used in the volatility tools
	* **Psxview** – find the hidden process  
	* **Cmdline** – Display the process in the command line
	* **Malfind** – helps to find the hidden and injected code
	* **Consoles** – extract the information using command history

To identify the profile of memory image
```
vol.py -f <memory image> imageinfo
```
To use Profile and Plugins 
```
Vol.py -f <memory image> --profile=<profile suggested from imageinfo> <plugins>
```





















